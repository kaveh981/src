# A Schema defining a valid array of Section objects for bulk import (See http://json-schema.org/latest/json-schema-validation.html)
#
title: sectionArray
type: array
uniqueItems: true
minItems: 1
items:
    title: section with url matches
    type: object
    description: A JSON schema defining how a valid matches required section instance should be represented
    format: section
    additionalProperties: false
    constraints:
        urlMatch: 
            -   entireSite: entireSite
                matches: matches
    properties:
        userID:
            $ref: "#/definitions/userID"
        name:
            $ref: "#/definitions/name"
        percent:
            $ref: "#/definitions/percent"
        siteID:
            $ref: "#/definitions/siteID"
        frequencyRestrictions:
            $ref: "#/definitions/frequencyRestrictions"
        audienceRestrictions:
            $ref: "#/definitions/audienceRestrictions"
        countryRestrictions:
            $ref: "#/definitions/countryRestrictions"
        adUnitRestrictions:
            $ref: "#/definitions/adUnitRestrictions"
        entireSite:
            enum: [0,1]
        matches:
            $ref: "#/definitions/matchesArray"               
    required: [userID, name, percent, entireSite, siteID]
   
definitions:
    userID:
        type: integer
        minimum: 1
        maximum: 16777215
    name:
        type: string
        minLength: 1
        maxLength: 100
    percent:
        type: integer
        minimum: 1
        maximum: 100
    siteID:
        type: array
        items:
            type: integer
            minimum: 1
            maximum: 4294967295
        minItems: 1
        maxItems: 5000
        uniqueItems: true
    audienceRestrictions:
        type: array
        items:
            type: integer
            minimum: 0
            maximum: 16777215
        minItems: 0
        uniqueItems: true
    countryRestrictions:
        type: array
        items:
            type: string
            pattern: ^(?!XX)([A-Z]{2})$
        minItems: 0
        uniqueItems: true
    adUnitRestrictions:
        type: array
        items:
            type: integer
            minimum: 1
            maximum: 255
        minItems: 0
        uniqueItems: true
    frequencyRestrictions:
        type: array
        items:
            type: integer
            minimum: 0
            maximum: 255
        minItems: 0
        uniqueItems: true
    matchesArray:
        type: array
        minItems: 1
        maxItems: 1000
        items:
            title: match
            description: url matching object
            type: object
            additionalProperties: false
            properties:
                matchType:
                    type: integer
                    minimum: 1
                    maximum: 2
                url:
                    type: string
                    $ref: "#/definitions/urlString"          
            required: [matchType, url]
    urlString:
        type: string
        minLength: 1
        